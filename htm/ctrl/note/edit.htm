<%!
from model.po import STATE_SECRET
from static import js, css
%>
<%inherit file="/ctrl/_base/1.htm" />
<%namespace file="/ctrl/_util/htm.htm" name="htm"/>

<%def name="htm_head()">
<%
if po:
    suffix = "/%s"%po.id
else:
    suffix = ""
%>
<script src="${js.upload}"></script>\
<script src="${js.pic}"></script>\
<script>
UPLOADURL = "/j/note/upload${suffix}"
DELETEURL = "/j/note/upload/rm${suffix}"
</script>
<link href="${css.po_note}" rel="stylesheet" type="text/css">
</%def>

<%htm:form enctype="multipart/form-data">
<div>
<input type="text" name="name" value="${po.name}">
</div>
<textarea name="txt">${po.txt}</textarea>
<div>
    <a id="upload" href="javascript:upload();void(0)">传图</a>
    <input type="checkbox" name="secret" id="secret"
%if po.state == STATE_SECRET: 
checked
%endif
    >\
%if po:
<a href="/po/rm/${po.id}?${_xsrf}">删除</a>
%endif
    <label for="secret">仅自己可见</label>\
    <button type="submit">确定</button>\
</div>

<div id="upload_wait">图片上传中 ...
<a href="javascript:cancel_uploading();void(0)">取消</a>
</div>


</%htm:form>

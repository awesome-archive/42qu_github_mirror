
<%!
from config import LOGO_TEXT, SITE_DOMAIN
from model.ico import ico_url_bind_with_default
from model.career import career_bind
from tornado.escape import json_encode 
from model.user_auth import user_password_verify, UserPassword, user_password_new
%>

<%inherit file="/ctrl/_base/_reg_base.htm" />
<%namespace file="/ctrl/_util/htm.htm" name="htm"/>

<%def name="H()">
</%def>
<%def name="T()"></%def>

<%def name="htm_head()">
<meta name="description" content=" 无数故事，读完后， 一笑而过。下班的地铁，你还是你，我还是我。认识一个人， 要多少缘分？茫茫人海，擦肩而过多少陌生人。42区，这是相遇的地方 ...">
<script src="${js.reg}"></script>
<script src="${js.pid}"></script>
<script src="${js.date}"></script>
${css.ctrl_auth_reg|n}
${css.ctrl_com_invite_reg|n}

</%def>

<%def name="h_nav()"></%def>

<%htm:form id="form_reg" >

<div class="head_hint">
<p class="hint_p p_b">欢迎来到<span class="hint_logo">42区</span> </p>
<p class="hint_p">人生初见 ，故事伊始 ，我们在此相遇相识 ...</p>
<p class="hint_p">首先 ，请介绍一下自己 :)</p>
</div>

<p class="line">
<label class="label_input" for="mail">性别</label>\
<select name="sex" class="sex_select">
<option value=""></option>
<option ${'selected' if sex==1 else ''} value="1">男</option>
<option ${'selected' if sex==2 else ''} value="2">女</option>
</select>\
<span class="sex_hint">注意 : 创建账号之后 , 无法修改此项</span>
</p>
${errtip.sex|n}

<p class="line">
<label class="label_input" for="name">名字</label>\
<input class="login_mail" id="name" autocomplete="off" type="text" name="name" value="${name or current_user.name or ''}"></p>
${errtip.name|n}

%if not UserPassword.get(current_user_id):
<p class="line">
<label class="label_input" for="password">密码</label>\
<input class="login_password" id="password" autocomplete="off" type="password" name="password">
</p>
${errtip.password|n}
%endif

<div class="cl btns" id="form_btn">
<span class="L btnw next_btn"><button type="submit" >下一步</button></span>
</div>
</div>
</%htm:form>

<script id="zsite_ico" type="text/x-jquery-tmpl">
<%text>
<div class="zsite_ico c">
<img src="${$data[0]}">
<div>${$data[1]}</div>
<div>${$data[2]}</div>
<div>${$data[3]}</div>
</div>
</%text>
</script>

%if zsite_list:
<%
ico_url_bind_with_default(zsite_list)
career_bind(zsite_list)
zsite_ico_list = []
for i in zsite_list:
    unit , title = i.career
    zsite_ico_list.append(
        ( i.ico, i.name, unit, title)
    )
%>
<script>
zsite_ico_list(${json_encode(zsite_ico_list)|n})
</script>
%endif


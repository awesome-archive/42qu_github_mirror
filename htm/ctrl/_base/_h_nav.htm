<%!
from config import SITE_DOMAIN, SITE_URL
from model.notice import notice_unread as _notice_unread
%>

<%def name="_h_nav_notice()">
<%
    link = current_user.link
%>\
<div class="D">\
<a class="DA" href="${link}/notice">提醒\
<%
notice_unread = _notice_unread.get(current_user_id)
%>\
    %if notice_unread:
<%
if notice_unread > 99:
    notice_unread = "99+"
%>\
<span>${notice_unread}</span>\
    %endif
</a>\
</div>\
</%def>




<%def name="_h_nav(
    nav_main = False, nav_self = False, nav_zsite = False, nav_account = False
)">
<div class="HN">\
<%
%>\
%if current_user:
<%
    link = current_user.link
%> 
<div class="D">\
<a class="DA" href="javascript:void(0)">更多</a>\
<div>\
    %if not nav_self:
<a href="${link}/live">主页</a>\
    %endif
    %if not nav_main:
<a href="${SITE_URL}">全站</a>\
    %endif
    %if not nav_account:
<a href="${link}/i">账号</a>\
    %endif
<a href="//help.${SITE_DOMAIN}">帮助</a>\
<a href="/logout?${_xsrf}">退出</a>\
</div>\
</div>\
${_h_nav_notice()}\
${callber.body()}\
<script>init_D()</script>\
%else:
<div class="D"><a href="/login" class="DA">登录</a></div>\
    %if zsite_id:
<div class="D"><a href="javascript:login();void(0);" class="DA">留言</a></div>\
    %else:
<div class="D"><a href="/auth/reg" class="DA">注册</a></div>\
    %endif
%endif
</div>\
</%def>


<%!
from config import SITE_DOMAIN, SITE_URL
from model.notice import notice_unread as _notice_unread
%>

<%def name="_h_nav_notice()">
<%
    link = current_user.link
%>\
<div class="D">\
<a class="DA" href="${link}/notice">提醒\
<%
notice_unread = _notice_unread.get(current_user_id)
%>\
    %if notice_unread:
<%
if notice_unread > 99:
    notice_unread = "99+"
%>\
<span>${notice_unread}</span>\
    %endif
</a>\
</div>\
</%def>



<%def name="_h_nav_logout()">
<div class="D"><a href="/login" class="DA">登录</a></div>\
    %if zsite_id:
<div class="D"><a href="javascript:login();void(0);" class="DA">留言</a></div>\
    %else:
<div class="D"><a href="/auth/reg" class="DA">注册</a></div>\
    %endif
</%def>



<%def name="_h_nav_self()">
<%
link = current_user.link
%>\
<div class="D">\
<a class="DA" rel="BLK" href="javascript:void(0)">我的</a>\
<div>\
    <a href="${link}">门户</a>\
    <a href="${link}/live">动态</a>\
    <a href="${link}/wall">关注</a>\
    <a href="${link}/wall">留言</a>\
</div>\
</div>\
<div class="D">\
<a class="DA" href="javascript:void(0)">发布</a>\
<div>\
    <a href="${link}/po/note">文章</a>
    <a href="${link}/po/question">问题</a>
</div>\
</div>\
</%def>


<%def name="_h_nav_zsite()">

</%def>

<%def name="_h_nav_main()">

</%def>

<%def name="_h_nav_account()">

</%def>

<%def name="_h_nav(
    nav_main = False, nav_self = False, nav_zsite = False, nav_account = False
)">
<div class="HN">\
<%
%>\
%if current_user:
<%
    link = current_user.link
%> 
<div class="D">\
<a class="DA" href="javascript:void(0)">更多</a>\
<div>\
    %if not nav_self:
<a href="${link}/live">主页</a>\
    %endif
    %if not nav_main:
<a href="${SITE_URL}">全站</a>\
    %endif
    %if not nav_account:
<a href="${link}/i">账号</a>\
    %endif
<a href="//help.${SITE_DOMAIN}">帮助</a>\
<a href="/logout?${_xsrf}">退出</a>\
</div>\
</div>\
${_h_nav_notice()}\
    %if nav_self:
${_h_nav_self()}\
    %elif nav_account:
${_h_nav_account()}\
    %elif nav_zsite:
${_h_nav_zsite()}\
    %elif nav_main:
${_h_nav_main()}\
    %endif
<script>init_D()</script>\
%else:
${_h_nav_logout()}\
%endif
</div>\
</%def>


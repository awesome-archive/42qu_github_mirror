<%!
from config import SITE_DOMAIN
from config import SITE_URL
from model.zsite import ZSITE_STATE_APPLY
from model.notice import notice_unread as _notice_unread
NAVURL = (
    ( '/i' , "账号"),
    ( '/po/word' , "微博"),
    ( '/po/note' , "文章"),
)
NAVURL_DICT = dict(NAVURL)
%>

<%namespace file="/ctrl/_util/htm.htm" name="htm"/>
<%inherit file="_base.htm" />

%if current_user:
%if current_user.state == ZSITE_STATE_APPLY:
<div id="T">请验证邮箱 ，<a href="/auth/verify/mail">点此重发验证邮件</a></div>
%endif
%elif zsite_id:
<div id="T">你想关注我吗 ? <a href="/auth/reg" style="text-decoration:underline;">点此注册</a> , 仅需一步</div>
%endif

${self.H()}
<div class="C">
    <div class="G"><div class="G4">${next.body()}</div></div>
</div>




<%def name="_H(htm)">
<div id="H"><div class="H\
%if htm:
">${htm|n}
%else:
 tc">\
%endif
<%
request_host = request.host
%>
<a
href="//${request_host}\
%if zsite_id==current_user_id:
/live\
%endif
"
class="site">${request_host}</a>
</div></div>
</%def>

<%def name="H()" filter="trim,_H">
${self.h_nav()}
</%def>





<%def name="h_nav()">
<div class="R">
%if current_user: 
<%
link = current_user.link
%>
<a class="DA" rel="PO" href="javascript:void(0)">发布</a>\
<div class="D" id="DPO">
    <a href="${link}/po/note">文章</a>
    <a href="${link}/po/question">问题</a>
</div>\
<a class="DA" rel="BLK" href="javascript:void(0)">版块</a>\
<div class="D" id="DBLK">
    <a href="${link}/live">动态</a>\
</div>\
<a class="DA" href="${link}/notice">提醒\
<%
notice_unread = _notice_unread.get(current_user_id)
%>\
%if notice_unread:
<span style="">${notice_unread}</span>\
%endif
</a>\
<a class="DA" href="javascript:void(0)" rel="MORE">更多</a>\
<div class="D" id="DMORE">
    <a href="${link}">个人</a>
    <a href="${link}/i">账号</a>
    <a href="//help.${SITE_DOMAIN}">帮助</a>
    <a href="/logout">退出</a>
</div>
<script>init_D()</script>
%else:
<a href="javascript:login();void(0);" class="DA">留言</a>\
<a href="/login" class="DA">登录</a>\
%endif
</div>
</%def>
